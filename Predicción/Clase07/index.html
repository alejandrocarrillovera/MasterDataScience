<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Modelos Series Temporales III</title>
  <meta name="description" content="Modelos Series Temporales III" />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="Modelos Series Temporales III" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Modelos Series Temporales III" />
  
  
  

<meta name="author" content="© Ricardo A. Queralt" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="modelos-var.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Modelos GARCH</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#bibliografía"><i class="fa fa-check"></i><b>1.1</b> Bibliografía</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#introducción"><i class="fa fa-check"></i><b>1.2</b> Introducción</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#volatilidad-hechos-característicos1"><i class="fa fa-check"></i><b>1.3</b> Volatilidad: Hechos Característicos</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#modelos-garch-1"><i class="fa fa-check"></i><b>1.4</b> Modelos GARCH</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#definición-modelo-garch"><i class="fa fa-check"></i><b>1.4.1</b> Definición Modelo GARCH</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#identificación-y-diagnosis"><i class="fa fa-check"></i><b>1.5</b> Identificación y Diagnosis</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ejemplo-ibm"><i class="fa fa-check"></i><b>1.6</b> Ejemplo: IBM</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-var.html"><a href="modelos-var.html"><i class="fa fa-check"></i><b>2</b> Modelos VAR</a><ul>
<li class="chapter" data-level="2.1" data-path="modelos-var.html"><a href="modelos-var.html#bibliografía-1"><i class="fa fa-check"></i><b>2.1</b> Bibliografía</a></li>
<li class="chapter" data-level="2.2" data-path="modelos-var.html"><a href="modelos-var.html#vectores-autorregresivos"><i class="fa fa-check"></i><b>2.2</b> Vectores Autorregresivos</a></li>
<li class="chapter" data-level="2.3" data-path="modelos-var.html"><a href="modelos-var.html#ejemplo-1"><i class="fa fa-check"></i><b>2.3</b> Ejemplo 1</a></li>
<li class="chapter" data-level="2.4" data-path="modelos-var.html"><a href="modelos-var.html#ejemplo-2"><i class="fa fa-check"></i><b>2.4</b> Ejemplo 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cointegración.html"><a href="cointegración.html"><i class="fa fa-check"></i><b>3</b> Cointegración</a><ul>
<li class="chapter" data-level="3.1" data-path="cointegración.html"><a href="cointegración.html#procedimiento-de-estimación-ante-series-temporales-no-estacionarias"><i class="fa fa-check"></i><b>3.1</b> PROCEDIMIENTO DE ESTIMACIÓN ANTE SERIES TEMPORALES NO ESTACIONARIAS</a></li>
<li class="chapter" data-level="3.2" data-path="cointegración.html"><a href="cointegración.html#estimación"><i class="fa fa-check"></i><b>3.2</b> Estimación</a><ul>
<li class="chapter" data-level="3.2.1" data-path="cointegración.html"><a href="cointegración.html#estacionariedad"><i class="fa fa-check"></i><b>3.2.1</b> Estacionariedad</a></li>
<li class="chapter" data-level="3.2.2" data-path="cointegración.html"><a href="cointegración.html#pruebas-de-cointegración"><i class="fa fa-check"></i><b>3.2.2</b> Pruebas de Cointegración</a></li>
<li class="chapter" data-level="3.2.3" data-path="cointegración.html"><a href="cointegración.html#modelo-de-corrección-de-errores.-ecm"><i class="fa fa-check"></i><b>3.2.3</b> Modelo de corrección de errores. (ECM)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="cointegración.html"><a href="cointegración.html#ejemplo-pair-trading"><i class="fa fa-check"></i><b>3.3</b> Ejemplo Pair Trading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cambio-de-regimen-hidden-markov-models-regime-switching.html"><a href="cambio-de-regimen-hidden-markov-models-regime-switching.html"><i class="fa fa-check"></i><b>4</b> Cambio de Regimen (Hidden Markov Models - Regime switching)</a><ul>
<li class="chapter" data-level="4.1" data-path="cambio-de-regimen-hidden-markov-models-regime-switching.html"><a href="cambio-de-regimen-hidden-markov-models-regime-switching.html#ejemplo"><i class="fa fa-check"></i><b>4.1</b> Ejemplo</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Series Temporales III</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Modelos Series Temporales III</h1>
<p class="author"><em>© Ricardo A. Queralt</em></p>
<p class="date"><em>MSDF: Clase 07 (Sesión 13 y 14)</em></p>
</div>
<div id="modelos-garch" class="section level1">
<h1><span class="header-section-number">1</span> Modelos GARCH</h1>
<div id="bibliografía" class="section level2">
<h2><span class="header-section-number">1.1</span> Bibliografía</h2>
<ul>
<li><p>An introduction to analysis of financial data with R.<br />
Ruey S. Tsay.<br />
WILEY 2013 (Tema 5)</p></li>
<li><p>Analysis of Financial Time Series. Third Edition<br />
RUEY S. TSAY<br />
WILEY (2010)<br />
<em>Capítulos: 3 y 9</em></p></li>
<li><p>Mastering R for Quantitative Finance.<br />
Packt Publishing. 2015.<br />
(Tema 1)</p></li>
<li><p>Engle y Patton (2001): “What good is a volatility model?”
Quantitative Finance.</p></li>
<li><p><a href="http://vlab.stern.nyu.edu/" class="uri">http://vlab.stern.nyu.edu/</a></p></li>
</ul>
</div>
<div id="introducción" class="section level2">
<h2><span class="header-section-number">1.2</span> Introducción</h2>
<p>Las series temporales de rentabilidad de activos financieros poseen unas
regularidades empíricas que se conocen en la literatura especializada
como hechos estilizados:</p>
<ul>
<li><p>Camino Aleatorio.</p></li>
<li><p>Colas pesadas (anchas)</p></li>
<li><p>Normalidad agregada</p></li>
<li><p>Volatilidad no constante y agrupada (volatility cluster)</p></li>
</ul>
<hr />
<p><img src="media/image1.png" style="width:4.11209in;height:3.35517in" /></p>
<hr />
<p><img src="media/image2.png" style="width:3.61557in;height:2.95005in" /></p>
<hr />
<p><img src="media/image3.png" style="width:3.48633in;height:2.8446in" />
<strong><em>
<img src="media/image4.png" style="width:3.73422in;height:3.04686in" />
</em></strong>
<img src="media/image5.png" style="width:3.88252in;height:3.16786in" /></p>
</div>
<div id="volatilidad-hechos-característicos1" class="section level2">
<h2><span class="header-section-number">1.3</span> Volatilidad: Hechos Característicos<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h2>
<p>Considerando una serie temporal de rendimientos <span class="math inline">\(r_t\)</span> con <span class="math inline">\(t=1,2,3, \dots,T\)</span>.</p>
<p>La varianza muestral de los rendimientos es :</p>
<p><span class="math display">\[
\sigma_{r_t}^2= \frac{1}{T-1} \sum_{t=1}^T(r_t-\bar{r})^2
\]</span></p>
<p>donde <span class="math inline">\(\bar{r}=\frac{1}{T}\sum_{t=1}{T}r_t\)</span> es la media muestral.</p>
<p>Este estadístico muestral (la varianza) se calcula con toda la muestra.
Si se calcula la varianza con la primera mitad de la muestra y se
compara con la varianza de la segunda mitad seguramente serán
diferentes.</p>
<p>Esto es, <strong>la varianza y su raíz cuadrada (desviación típica o
volatilidad) son cambiantes en el tiempo (No son constantes).</strong></p>
<hr />
<p>De una manera intuitiva, la volatilidad es una medida de cuánto la
rentabilidad fluctúa alrededor de su media.</p>
<p><strong>Es una medida del riesgo.</strong></p>
<p>Por lo tanto, es importante, poder calcular esta volatilidad en
cualquier instante, para analizar cómo varía con el tiempo y para
predecir sus valores futuros.</p>
<p>Más formalmente, sea <span class="math inline">\(r_t=\mu+\epsilon_t\)</span> una serie temporal de los rendimientos, donde <span class="math inline">\(\mu\)</span> es la rentabilidad media o esperada y <span class="math inline">\(\epsilon_t\)</span> es el error que se expresa como:
<span class="math display">\[
\epsilon_t=\sigma_t \cdot z_t 
\]</span></p>
<p>donde <span class="math inline">\(z_t\)</span> un ruido blanco gaussiano de media cero y <span class="math inline">\(\sigma_t\)</span> es una volatilidad
cambiante en el tiempo que definimos como heterocesdasticidad
condicional. De tal forma, que la volatilidad futura se puede predecir
basándose en su volatilidad pasada y otras variables condicionantes.</p>
<hr />
<p>Con el fin de realizar el análisis de la volatilidad, es necesario
especificar esta dependencia, para lo que se utilizan los modelos del
tipo <strong>de Heteroscedasticidad condicional autorregresiva generalizada
(GARCH)</strong>.</p>
<p>Algunos fenómenos se observan sistemáticamente en casi todas las series
temporales de rentabilidad. Un buen modelo de heteroscedasticidad
condicional debe ser capaz de captar la mayoría de estos hechos.</p>
<p>Los hechos estilizados más conocidos en el análisis de la volatilidad
son:</p>
<ul>
<li><p><strong>Los clusters de volatilidad</strong>: La volatilidad es más probable que
sea alta en el momento t si también fue alta en el momento t-1. Es
decir, un shock en el momento t-1 aumenta no sólo la varianza en el
tiempo t-1, sino también la varianza en el tiempo t. Así, los
mercados son más volátiles en algunos períodos, y son más tranquilo
que en otros. Las volatilidades están agrupados en el tiempo. Los
modelos de tipo GARCH capturar este efecto. De hecho, estos modelos
son precisamente una forma de especificar cómo la volatilidad en el
tiempo t depende de la volatilidad pasada (y posiblemente otras
variables condicionales).</p></li>
<li><p><strong>Colas gruesas (anchas)</strong>: Las rentabilidades generalmente
presentar colas gruesas, también conocido como el exceso de curtosis
o leptokurtosis. Es decir, su curtosis es generalmente mayor que
tres, recordar que ese es el valor de la curtosis de una variable
aleatoria gaussiana o normal. Para comprobar este comportamiento se
puede realizar un contraste Jarque-Bera, para verificar de forma
conjunta tanto si la distribución es simétrica y si la distribución
presenta curtosis igual a tres y es normal.</p>
<p>Si los rendimientos son de cola ancha, la probabilidad de tener
eventos extremos (rendimientos muy altos o muy bajos) es más alta de
lo que sería en el caso normal.</p></li>
<li><p><strong>Asimetría:</strong> Hay un hecho estilizado que el modelo GARCH normal no
es capaz de capturar, que es el hecho observado empíricamente que
los shocks negativos en el momento t-1 tienen un mayor impacto en la
variación en el tiempo t que los shocks positivos. Sin embargo, el
modelo GARCH puede ser fácilmente modificado para capturar
esta asimetría. Ejemplos de estas generalizaciones son los GARCH
Umbral (TGARCH), el asimétrico GARCH (AGARCH) y la exponencial
GARCH (EGARCH).</p>
<p>Esta asimetría se llama efecto de
influencia/apalancamiento (leverage) debido a que el aumento del
riesgo proviene de la creciente influencia generada por un
shock negativo.</p></li>
</ul>
</div>
<div id="modelos-garch-1" class="section level2">
<h2><span class="header-section-number">1.4</span> Modelos GARCH</h2>
<p>Para construir un modelo de volatilidad para los rendimientos de un
activo debemos tener en cuenta cuatro etapas:</p>
<ol style="list-style-type: decimal">
<li>Especificar un modelo para la media, si es necesario estimar un
modelo ARIMA para modelizar la dependencia lineal, de tal forma que el termino de error sea ruido blanco (media cero y sin autocorrelación):</li>
</ol>
<p><span class="math display">\[
    \text{ECUACIÓN DE LA MEDIA}\\
    r_t=\mu+\epsilon_t \equiv \text{Modelo con Constante} \\
    r_t=\mu+ARIMA(p,d,q)+\epsilon_t \equiv \text{Modelo con ARIMA} 
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Usar los residuos de la ecuación de la media para verificar
efectos ARCH.</p></li>
<li><p>Especificar un modelo GARCH y estimar conjunto el modelo de la media
y de la volatilidad.</p></li>
<li><p>Verificar que el modelo ajustado y reestimar si es necesario.</p></li>
</ol>
<div id="definición-modelo-garch" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Definición Modelo GARCH</h3>
<p>Sea <span class="math inline">\(r_t=\mu+\epsilon_t\)</span> una serie temporal de los rendimientos, donde <span class="math inline">\(\mu\)</span> es la rentabilidad media o esperada y <span class="math inline">\(\epsilon_t\)</span> es el error que se expresa como:
<span class="math display">\[
\epsilon_t=\sigma_t \cdot z_t 
\]</span></p>
<p>donde <span class="math inline">\(z_t\)</span> un ruido blanco gaussiano de media cero y se dice que <span class="math inline">\(\epsilon_t \sim GARCH(p,q)\)</span> si:</p>
<p><span class="math display">\[
\sigma_t^2=\omega+\alpha_1\epsilon_{t-1}^2+\dots+\alpha_p\epsilon_{t-p}^2+\beta_1\sigma_{t-1}^2+\dots+\beta_q\sigma_{t-q}^2
\]</span></p>
<p>Los modelos se pueden seleccionar utilizando un criterio de información (AIC, BIC
o SIC).</p>
<hr />
<p>Como caso particular se encuentran:</p>
<p><span class="math display">\[
\text{ARCH(p)}\\
\sigma_t^2=\omega+\alpha_1\epsilon_{t-1}^2+\dots+\alpha_p\epsilon_{t-p}^2\\
\\
\text{GARCH(1,1)}\\
\sigma_t^2=\omega+\alpha_1\epsilon_{t-1}^2+\alpha_p\epsilon_{t-p}^2+\beta_1\sigma_{t-1}^2
\]</span></p>
<p>El <strong>GARCH(1,1)</strong> es el modelo mas utilizado, en realidad es un
ARMA(1,1) sobre la varianza de los errores.</p>
<p>En este modelo se debe cumplir que <span class="math inline">\(\alpha_1+\beta_1&lt;1\)</span>, caracterizándose la volatilidad por revertir a la media, fluctuando alrededor la raíz de la varianza
incondicional:
<span class="math display">\[
\sigma^2\equiv Var(r_t)=\frac{\omega}{1-\alpha_1-\beta_1}
\]</span></p>
<p>Además, debe cumplirse que <span class="math inline">\(\omega,\alpha_1,\beta_1&gt;0\)</span>.</p>
<hr />
<p>En cuanto a la predicción de la varianza horizonte <em>h</em> será:</p>
<p><span class="math display">\[
\hat \sigma _{T + h}^2 = \hat \omega  + \left( {\hat{\alpha _1} + \hat {\beta _1}} \right)\hat \sigma _{T + h - 1}^2
\]</span></p>
<p>En cuanto a la volatilidad compuesta será:</p>
<p><span class="math display">\[
{\hat \sigma _{T + 1:T + h}} = \sqrt {\sum\limits_{i = 1}^h {\hat \sigma _{T + i}^2} }  \to \sqrt h \sqrt {\frac{{\hat \omega }}{{1 - {{\hat \alpha }_1} - {{\hat \beta }_1}}}}
\]</span>
Otros modelos son:</p>
<p><img src="media/image29.png" /></p>
</div>
</div>
<div id="identificación-y-diagnosis" class="section level2">
<h2><span class="header-section-number">1.5</span> Identificación y Diagnosis</h2>
<p>Las herramientas para la identificación y diagnosis del modelo GARCH
son:</p>
<ol style="list-style-type: decimal">
<li><p>Gráfico de los rendimientos al cuadrado o valor absoluto.</p></li>
<li><p>ACF y PACF de los rendimientos al cuadrado o valor absoluto.</p></li>
<li><p>Test Ljung-Box de los rendimientos al cuadrado o valor absoluto.</p></li>
<li><p>Test de Multiplicadores de Langrage de Engle (LM), donde la
hipótesis nula es de no GARCH.</p></li>
</ol>
<p><span class="math display">\[
    \begin{gathered}
  \,\varepsilon _t^2 = {\alpha _0} + {\alpha _1}\varepsilon _{t - 1}^2 +  \cdots  + {\alpha _m}\varepsilon _{t - m}^2 + error \hfill \\
  {H_0}:\,{\alpha _0} = {\alpha _1} =  \cdots  = {\alpha _m} = 0 \hfill \\
  {H_1}:{\alpha _i} \ne 0 \hfill \\ 
\end{gathered}
\]</span></p>
</div>
<div id="ejemplo-ibm" class="section level2">
<h2><span class="header-section-number">1.6</span> Ejemplo: IBM</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="index.html#cb3-1"></a><span class="co"># Volatility </span></span>
<span id="cb3-2"><a href="index.html#cb3-2"></a><span class="co">#Stylized facts and GARCH models</span></span>
<span id="cb3-3"><a href="index.html#cb3-3"></a><span class="co">#(c)Ricardo A. Queralt</span></span>
<span id="cb3-4"><a href="index.html#cb3-4"></a><span class="co"># References:</span></span>
<span id="cb3-5"><a href="index.html#cb3-5"></a><span class="co">#   Tsay(2013)</span></span>
<span id="cb3-6"><a href="index.html#cb3-6"></a><span class="co">#   </span></span>
<span id="cb3-7"><a href="index.html#cb3-7"></a></span>
<span id="cb3-8"><a href="index.html#cb3-8"></a></span>
<span id="cb3-9"><a href="index.html#cb3-9"></a><span class="kw">library</span>(<span class="st">&quot;quantmod&quot;</span>) <span class="co">#Package to download financials historical data </span></span>
<span id="cb3-10"><a href="index.html#cb3-10"></a><span class="kw">library</span>(forecast)</span>
<span id="cb3-11"><a href="index.html#cb3-11"></a><span class="kw">library</span>(<span class="st">&quot;fGarch&quot;</span>)</span>
<span id="cb3-12"><a href="index.html#cb3-12"></a></span>
<span id="cb3-13"><a href="index.html#cb3-13"></a></span>
<span id="cb3-14"><a href="index.html#cb3-14"></a><span class="co">#funciones</span></span>
<span id="cb3-15"><a href="index.html#cb3-15"></a>archTest &lt;-<span class="st"> </span><span class="cf">function</span>(rtn,<span class="dt">m=</span><span class="dv">10</span>){</span>
<span id="cb3-16"><a href="index.html#cb3-16"></a>  <span class="co"># Perform Lagrange Multiplier Test for ARCH effect of a time series</span></span>
<span id="cb3-17"><a href="index.html#cb3-17"></a>  <span class="co"># rtn: time series</span></span>
<span id="cb3-18"><a href="index.html#cb3-18"></a>  <span class="co"># m: selected AR order</span></span>
<span id="cb3-19"><a href="index.html#cb3-19"></a>  <span class="co"># TSAY(2013)</span></span>
<span id="cb3-20"><a href="index.html#cb3-20"></a>  y=(rtn<span class="op">-</span><span class="kw">mean</span>(rtn))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb3-21"><a href="index.html#cb3-21"></a>  T=<span class="kw">length</span>(rtn)</span>
<span id="cb3-22"><a href="index.html#cb3-22"></a>  atsq=y[(m<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>T]</span>
<span id="cb3-23"><a href="index.html#cb3-23"></a>  x=<span class="kw">matrix</span>(<span class="dv">0</span>,(T<span class="op">-</span>m),m)</span>
<span id="cb3-24"><a href="index.html#cb3-24"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb3-25"><a href="index.html#cb3-25"></a>    x[,i]=y[(m<span class="op">+</span><span class="dv">1</span><span class="op">-</span>i)<span class="op">:</span>(T<span class="op">-</span>i)]</span>
<span id="cb3-26"><a href="index.html#cb3-26"></a>  }</span>
<span id="cb3-27"><a href="index.html#cb3-27"></a>  md=<span class="kw">lm</span>(atsq<span class="op">~</span>x)</span>
<span id="cb3-28"><a href="index.html#cb3-28"></a>  <span class="kw">summary</span>(md)</span>
<span id="cb3-29"><a href="index.html#cb3-29"></a>}</span>
<span id="cb3-30"><a href="index.html#cb3-30"></a></span>
<span id="cb3-31"><a href="index.html#cb3-31"></a></span>
<span id="cb3-32"><a href="index.html#cb3-32"></a><span class="co">###FIN FUNCIONES</span></span>
<span id="cb3-33"><a href="index.html#cb3-33"></a></span>
<span id="cb3-34"><a href="index.html#cb3-34"></a></span>
<span id="cb3-35"><a href="index.html#cb3-35"></a></span>
<span id="cb3-36"><a href="index.html#cb3-36"></a></span>
<span id="cb3-37"><a href="index.html#cb3-37"></a><span class="co">#Yahoo ticker (stock or index) </span></span>
<span id="cb3-38"><a href="index.html#cb3-38"></a>sSymbol=<span class="st">&quot;IBM&quot;</span></span>
<span id="cb3-39"><a href="index.html#cb3-39"></a></span>
<span id="cb3-40"><a href="index.html#cb3-40"></a><span class="co">#get data from yahoo</span></span>
<span id="cb3-41"><a href="index.html#cb3-41"></a>mData&lt;-<span class="kw">getSymbols</span>(sSymbol ,<span class="dt">from=</span><span class="st">&quot;1990-01-01&quot;</span>,<span class="dt">to=</span><span class="st">&quot;2016-09-30&quot;</span>,<span class="dt">auto.assign=</span><span class="ot">FALSE</span>)</span>
<span id="cb3-42"><a href="index.html#cb3-42"></a><span class="co">#Define workdata</span></span>
<span id="cb3-43"><a href="index.html#cb3-43"></a>xData=<span class="kw">Ad</span>(mData)</span>
<span id="cb3-44"><a href="index.html#cb3-44"></a></span>
<span id="cb3-45"><a href="index.html#cb3-45"></a><span class="co">#Calculate Daily Arithmetic Return</span></span>
<span id="cb3-46"><a href="index.html#cb3-46"></a>dRentCont=<span class="kw">dailyReturn</span>(xData,<span class="dt">type=</span><span class="st">&#39;log&#39;</span>,<span class="dt">leading=</span><span class="ot">FALSE</span>)</span>
<span id="cb3-47"><a href="index.html#cb3-47"></a><span class="co">#Exclude NA (First data)</span></span>
<span id="cb3-48"><a href="index.html#cb3-48"></a>dRentCont=<span class="kw">na.exclude</span>(dRentCont)</span>
<span id="cb3-49"><a href="index.html#cb3-49"></a></span>
<span id="cb3-50"><a href="index.html#cb3-50"></a><span class="kw">plot.zoo</span>(<span class="kw">cbind</span>(xData,dRentCont),<span class="dt">main=</span><span class="kw">paste</span>(sSymbol,<span class="st">&quot; y  Rentabilidad&quot;</span>),<span class="dt">xlab=</span><span class="st">&quot;años&quot;</span>,<span class="dt">ylab=</span><span class="kw">c</span>(<span class="st">&quot;Precio&quot;</span>,<span class="st">&quot;rentabilidad&quot;</span>))</span>
<span id="cb3-51"><a href="index.html#cb3-51"></a><span class="kw">grid</span>(<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-52"><a href="index.html#cb3-52"></a></span>
<span id="cb3-53"><a href="index.html#cb3-53"></a></span>
<span id="cb3-54"><a href="index.html#cb3-54"></a><span class="co">#Volatilidad GARCH</span></span>
<span id="cb3-55"><a href="index.html#cb3-55"></a><span class="co">#Plot return squared</span></span>
<span id="cb3-56"><a href="index.html#cb3-56"></a><span class="kw">plot.zoo</span>(<span class="kw">cbind</span>(<span class="kw">Ad</span>(mData),dRentCont,dRentCont<span class="op">^</span><span class="dv">2</span>),<span class="dt">main=</span><span class="kw">paste</span>(sSymbol,<span class="st">&quot; y  Rentabilidad&quot;</span>),<span class="dt">xlab=</span><span class="st">&quot;años&quot;</span>,<span class="dt">ylab=</span><span class="kw">c</span>(<span class="st">&quot;Precio&quot;</span>,<span class="st">&quot;rentabilidad&quot;</span>,<span class="st">&quot;Volatilidad&quot;</span>))</span>
<span id="cb3-57"><a href="index.html#cb3-57"></a></span>
<span id="cb3-58"><a href="index.html#cb3-58"></a><span class="co">#testing mean</span></span>
<span id="cb3-59"><a href="index.html#cb3-59"></a><span class="kw">t.test</span>(dRentCont)</span>
<span id="cb3-60"><a href="index.html#cb3-60"></a></span>
<span id="cb3-61"><a href="index.html#cb3-61"></a><span class="co">#ACF &amp; PACF </span></span>
<span id="cb3-62"><a href="index.html#cb3-62"></a><span class="co"># VolProxy=abs(dRentCont) # absolute value</span></span>
<span id="cb3-63"><a href="index.html#cb3-63"></a>VolProxy=dRentCont<span class="op">^</span><span class="dv">2</span> <span class="co">#squared</span></span>
<span id="cb3-64"><a href="index.html#cb3-64"></a></span>
<span id="cb3-65"><a href="index.html#cb3-65"></a></span>
<span id="cb3-66"><a href="index.html#cb3-66"></a><span class="co">#ACF y PACF</span></span>
<span id="cb3-67"><a href="index.html#cb3-67"></a><span class="kw">tsdisplay</span>(VolProxy) </span>
<span id="cb3-68"><a href="index.html#cb3-68"></a></span>
<span id="cb3-69"><a href="index.html#cb3-69"></a><span class="co">#Ljung-Box Test </span></span>
<span id="cb3-70"><a href="index.html#cb3-70"></a><span class="kw">Box.test</span>(VolProxy,<span class="dt">lag=</span><span class="dv">10</span>,  <span class="dt">type=</span><span class="st">&quot;Lj&quot;</span>)</span>
<span id="cb3-71"><a href="index.html#cb3-71"></a><span class="kw">Box.test</span>(VolProxy,<span class="dt">lag=</span><span class="dv">20</span>,  <span class="dt">type=</span><span class="st">&quot;Lj&quot;</span>)</span>
<span id="cb3-72"><a href="index.html#cb3-72"></a><span class="kw">Box.test</span>(VolProxy,<span class="dt">lag=</span><span class="dv">40</span>,  <span class="dt">type=</span><span class="st">&quot;Lj&quot;</span>)</span>
<span id="cb3-73"><a href="index.html#cb3-73"></a></span>
<span id="cb3-74"><a href="index.html#cb3-74"></a><span class="co">#LM test</span></span>
<span id="cb3-75"><a href="index.html#cb3-75"></a><span class="kw">archTest</span>(dRentCont,<span class="dv">20</span>)</span>
<span id="cb3-76"><a href="index.html#cb3-76"></a></span>
<span id="cb3-77"><a href="index.html#cb3-77"></a><span class="co">#ARCH(1)</span></span>
<span id="cb3-78"><a href="index.html#cb3-78"></a>m1=<span class="kw">garchFit</span>(<span class="op">~</span><span class="dv">1</span><span class="op">+</span><span class="kw">garch</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">data=</span>dRentCont,<span class="dt">trace=</span>F) <span class="co"># Fit an ARCH(1) model</span></span>
<span id="cb3-79"><a href="index.html#cb3-79"></a><span class="kw">summary</span>(m1)</span>
<span id="cb3-80"><a href="index.html#cb3-80"></a>resi=<span class="kw">residuals</span>(m1,<span class="dt">standardize=</span>T) <span class="co">#residuals</span></span>
<span id="cb3-81"><a href="index.html#cb3-81"></a>resi=<span class="kw">xts</span>(resi,<span class="dt">order.by=</span><span class="kw">index</span>(dRentCont)) <span class="co">#residuals as xts</span></span>
<span id="cb3-82"><a href="index.html#cb3-82"></a><span class="kw">tsdisplay</span>(resi<span class="op">^</span><span class="dv">2</span>) <span class="co">#acf pacf residuals</span></span>
<span id="cb3-83"><a href="index.html#cb3-83"></a></span>
<span id="cb3-84"><a href="index.html#cb3-84"></a><span class="co">#GARCH(1,1)</span></span>
<span id="cb3-85"><a href="index.html#cb3-85"></a>m2=<span class="kw">garchFit</span>(<span class="op">~</span><span class="dv">1</span><span class="op">+</span><span class="kw">garch</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">data=</span>dRentCont,<span class="dt">trace=</span>F) <span class="co"># Fit an GARCH(1,1) model</span></span>
<span id="cb3-86"><a href="index.html#cb3-86"></a><span class="kw">summary</span>(m2)</span>
<span id="cb3-87"><a href="index.html#cb3-87"></a></span>
<span id="cb3-88"><a href="index.html#cb3-88"></a>resi=<span class="kw">residuals</span>(m2,<span class="dt">standardize=</span>T) <span class="co">#residuals</span></span>
<span id="cb3-89"><a href="index.html#cb3-89"></a>resi=<span class="kw">xts</span>(resi,<span class="dt">order.by=</span><span class="kw">index</span>(dRentCont)) <span class="co">#residuals as xts</span></span>
<span id="cb3-90"><a href="index.html#cb3-90"></a><span class="kw">tsdisplay</span>(resi<span class="op">^</span><span class="dv">2</span>) <span class="co">#acf pacf residuals</span></span>
<span id="cb3-91"><a href="index.html#cb3-91"></a><span class="kw">plot</span>(m2)</span>
<span id="cb3-92"><a href="index.html#cb3-92"></a></span>
<span id="cb3-93"><a href="index.html#cb3-93"></a></span>
<span id="cb3-94"><a href="index.html#cb3-94"></a><span class="co">#t-student</span></span>
<span id="cb3-95"><a href="index.html#cb3-95"></a>m3=<span class="kw">garchFit</span>(<span class="op">~</span><span class="dv">1</span><span class="op">+</span><span class="kw">garch</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">data=</span>dRentCont,<span class="dt">trace=</span>F,<span class="dt">cond.dist=</span><span class="st">&quot;std&quot;</span>)</span>
<span id="cb3-96"><a href="index.html#cb3-96"></a><span class="kw">summary</span>(m3)</span>
<span id="cb3-97"><a href="index.html#cb3-97"></a><span class="kw">plot</span>(m3)</span>
<span id="cb3-98"><a href="index.html#cb3-98"></a></span>
<span id="cb3-99"><a href="index.html#cb3-99"></a></span>
<span id="cb3-100"><a href="index.html#cb3-100"></a>v1=<span class="kw">volatility</span>(m3)  <span class="co"># Obtain volatility</span></span>
<span id="cb3-101"><a href="index.html#cb3-101"></a>v1=<span class="kw">xts</span>(v1,<span class="dt">order.by=</span><span class="kw">index</span>(dRentCont)) <span class="co">#  volatility as XTS</span></span>
<span id="cb3-102"><a href="index.html#cb3-102"></a><span class="kw">plot</span>(<span class="kw">sqrt</span>(<span class="dv">252</span>)<span class="op">*</span>v1)</span>
<span id="cb3-103"><a href="index.html#cb3-103"></a></span>
<span id="cb3-104"><a href="index.html#cb3-104"></a>resi=<span class="kw">residuals</span>(m3,<span class="dt">standardize=</span>T) <span class="co"># Standardized residuals</span></span>
<span id="cb3-105"><a href="index.html#cb3-105"></a>resi=<span class="kw">xts</span>(resi,<span class="dt">order.by=</span><span class="kw">index</span>(dRentCont)) <span class="co"># Standardized residuals as XTS</span></span>
<span id="cb3-106"><a href="index.html#cb3-106"></a><span class="kw">tsdisplay</span>(resi<span class="op">^</span><span class="dv">2</span>) <span class="co">#acf pacf residuals</span></span>
<span id="cb3-107"><a href="index.html#cb3-107"></a><span class="kw">plot</span>(resi)</span>
<span id="cb3-108"><a href="index.html#cb3-108"></a></span>
<span id="cb3-109"><a href="index.html#cb3-109"></a><span class="kw">predict</span>(m3) <span class="co">#forecast volatility</span></span>
<span id="cb3-110"><a href="index.html#cb3-110"></a><span class="kw">predict</span>(m3, <span class="dt">n.ahead =</span> <span class="dv">10</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>, <span class="dt">crit_val=</span><span class="dv">2</span>) <span class="co">#plot with 2*standard error</span></span>
<span id="cb3-111"><a href="index.html#cb3-111"></a><span class="kw">predict</span>(m3,<span class="dt">n.ahead=</span><span class="dv">20</span>,<span class="dt">plot=</span><span class="ot">TRUE</span>,<span class="dt">conf=</span>.<span class="dv">9</span>,<span class="dt">nx=</span><span class="dv">100</span>) <span class="co"># plot 100 data with 90% confidence</span></span></code></pre></div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="http://vlab.stern.nyu.edu/doc/1?topic=apps" class="uri">http://vlab.stern.nyu.edu/doc/1?topic=apps</a><a href="index.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="modelos-var.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
